{% extends 'base.html' %}
{% block content %}

<div class="d-flex align-items-center justify-content-between mb-3">
  <h2 class="mb-0 fw-bold">Series de Tiempo</h2>
  <span class="text-muted small">Demo de suavizado y pronóstico</span>
 </div>

<form method="post" class="mb-4">
  <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
  <div class="row g-3">
    <div class="col-md-4">
      <label for="method" class="form-label">Método</label>
      <select id="method" name="method" class="form-select">
        <option value="rolling">Media móvil</option>
        <option value="exp">Suavizado exponencial</option>
      </select>
    </div>
    <div class="col-md-4">
      <label for="window" class="form-label">Ventana</label>
      <input type="number" id="window" name="window" min="1" value="5" class="form-control">
    </div>
    <div class="col-md-4">
      <label for="alpha" class="form-label">Parámetro</label>
      <input type="number" step="0.1" id="alpha" name="alpha" value="0.3" class="form-control">
    </div>
  </div>
  <div class="mt-3">
    <button type="submit" class="btn btn-primary">Procesar</button>
  </div>
</form>

{% if fig_json %}
  <div id="tsChart" style="height:400px"></div>
  <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
  <script>
    const fig = {{ fig_json|safe }};
    Plotly.react('tsChart', fig.data, fig.layout);
  </script>
  {% if metrics %}
    <pre class="mt-3">{{ metrics|tojson(indent=2) }}</pre>
  {% endif %}
{% endif %}

{% endblock %}

