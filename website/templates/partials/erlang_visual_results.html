{% if metrics %}
{% set wait_color = queue.color if queue else '#FFD166' %}
<div class="metrics-grid mb-3">
  <div class="metric-card {{ metrics.sl_class }}">
    <h3>Service Level</h3>
    <h2>{{ (metrics.service_level * 100)|round(1) }}%</h2>
  </div>
  <div class="metric-card {{ metrics.asa_class }}">
    <h3>ASA</h3>
    <h2>{{ metrics.asa|round(1) }}s</h2>
  </div>
  <div class="metric-card {{ metrics.occ_class }}">
    <h3>Ocupaci√≥n</h3>
    <h2>{{ (metrics.occupancy * 100)|round(1) }}%</h2>
  </div>
</div>
<div class="d-flex justify-content-center mb-3">
  <div class="metrics-circle" style="background: conic-gradient(#EF476F {{ metrics.busy_percent }}%, {{ wait_color }} {{ metrics.busy_percent }}% {{ metrics.busy_percent + metrics.waiting_percent }}%, #06D6A0 {{ metrics.busy_percent + metrics.waiting_percent }}%);">
    <div class="metrics-circle-label">
      <div>Ocupados {{ metrics.busy_agents }}</div>
      <div>Esperando {{ metrics.waiting_calls }}</div>
      <div>Disponibles {{ metrics.available_agents }}</div>
    </div>
  </div>
</div>
<div class="progress mb-3" style="height:20px;">
  <div class="progress-bar" role="progressbar" style="width: {{ metrics.busy_percent }}%; background-color: #EF476F;">
    Ocupados {{ metrics.busy_agents }}
  </div>
  <div class="progress-bar" role="progressbar" style="width: {{ metrics.waiting_percent }}%; background-color: {{ wait_color }};">
    Esperando {{ metrics.waiting_calls }}
  </div>
  <div class="progress-bar" role="progressbar" style="width: {{ metrics.available_percent }}%; background-color: #06D6A0;">
    Disponibles {{ metrics.available_agents }}
  </div>
</div>
{% endif %}

{% include 'partials/erlang_visual_matrix.html' %}
{% include 'partials/erlang_visual_asa.html' %}
