{% extends "base.html" %}
{% block title %}Resultados — Generador de Turnos{% endblock %}

{% block body %}
<h3 class="mb-3">Resultados de Optimización</h3>

{% if payload %}
  <div class="card mb-3">
    <div class="card-body">
      <div class="metrics">
        <div class="metric">
          <div class="k">{{ payload.metrics.agents }}</div>
          <div class="l">Agentes asignados</div>
        </div>
        <div class="metric">
          <div class="k">{{ payload.metrics.coverage_percentage }}%</div>
          <div class="l">Cobertura</div>
        </div>
        <div class="metric">
          <div class="k">{{ payload.metrics.excess }}</div>
          <div class="l">Exceso (agentes-hora)</div>
        </div>
        <div class="metric">
          <div class="k">{{ payload.metrics.deficit }}</div>
          <div class="l">Déficit (agentes-hora)</div>
        </div>
      </div>
    </div>
  </div>

  <div class="card mb-3">
    <div class="card-body">
      <h5 class="card-title mb-2">Demanda por Hora y Día</h5>
      <img class="plot" src="data:image/png;base64,{{ payload.figures.demand_png }}" alt="Demanda"/>
    </div>
  </div>

  <div class="card mb-3">
    <div class="card-body">
      <h5 class="card-title mb-2">Cobertura por Hora y Día</h5>
      <img class="plot" src="data:image/png;base64,{{ payload.figures.coverage_png }}" alt="Cobertura"/>
    </div>
  </div>

  <div class="card mb-3">
    <div class="card-body">
      <h5 class="card-title mb-2">Cobertura - Demanda (exceso/déficit)</h5>
      <img class="plot" src="data:image/png;base64,{{ payload.figures.diff_png }}" alt="Diferencias"/>
    </div>
  </div>
{% else %}
  <div class="alert alert-warning">No hay resultados para mostrar.</div>
{% endif %}

<div class="mt-3">
  <a href="/generador" class="btn btn-outline-light">← Nueva optimización</a>
</div>
{% endblock %}
