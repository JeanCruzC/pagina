{% extends "base.html" %}
{% block title %}Generador de Turnos ‚Äî Modo Streamlit{% endblock %}

{% block body %}
<h3 class="mb-3">Generador de Turnos v6.2 ‚Äî Sistema Corregido</h3>

<div class="d-flex gap-3">
  <!-- Sidebar -->
  <div class="sidebar">
    <div class="card mb-3">
      <div class="card-body">
        <h5 class="card-title mb-3">‚öôÔ∏è Configuraci√≥n</h5>

        <form action="/generador" method="POST" enctype="multipart/form-data" id="form-opt">

          <div class="mb-3">
            <label class="form-label">Iteraciones JEAN</label>
            <input class="form-control" type="number" name="iterations" value="3" min="1" max="10"/>
          </div>

          <div class="mb-3">
            <label class="form-label">Tiempo solver (s)</label>
            <input class="form-control" type="number" name="solver_time" value="120" min="5" step="5"/>
          </div>

          <div class="mb-3">
            <label class="form-label">Cobertura objetivo (%)</label>
            <input class="form-control" type="number" name="coverage" value="98" min="80" max="100"/>
          </div>

          <div class="mb-3">
            <label class="form-label">Break desde inicio (horas)</label>
            <input class="form-control" type="number" step="0.5" name="break_from_start" value="2"/>
          </div>

          <div class="mb-3">
            <label class="form-label">Break antes del fin (horas)</label>
            <input class="form-control" type="number" step="0.5" name="break_from_end" value="2"/>
          </div>

          <div class="form-check mb-2">
            <input class="form-check-input" type="checkbox" id="ft" name="use_ft" value="true" checked>
            <label class="form-check-label" for="ft">Full Time (48h)</label>
          </div>
          <div class="form-check mb-3">
            <input class="form-check-input" type="checkbox" id="pt" name="use_pt" value="true" checked>
            <label class="form-check-label" for="pt">Part Time (24h)</label>
          </div>

          <!-- ocultos fijos para igualar a tu perfil JEAN -->
          <input type="hidden" name="profile" value="JEAN"/>
          <input type="hidden" name="agent_limit_factor" value="30"/>
          <input type="hidden" name="excess_penalty" value="5"/>
          <input type="hidden" name="peak_bonus" value="2"/>
          <input type="hidden" name="critical_bonus" value="2.5"/>
          <input type="hidden" name="optimization_profile" value="JEAN"/>

          <hr class="my-3" />
          <div class="mb-3">
            <label class="form-label">Archivo de demanda (.xlsx)</label>
            <input class="form-control" type="file" name="file" accept=".xlsx,.xls" required/>
          </div>

          <button class="btn btn-primary w-100" type="submit">üöÄ Ejecutar Optimizaci√≥n</button>
        </form>
      </div>
    </div>
  </div>

  <!-- Contenido principal -->
  <div class="content">
    <div class="card">
      <div class="card-body">
        <div class="badge badge-soft">Modo Streamlit (s√≠ncrono)</div>
        <div class="mt-2 text-muted">Sube tu Excel y se calcular√° todo en esta misma p√°gina.</div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
