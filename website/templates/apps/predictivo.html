{% extends 'apps/layout.html' %}

{% block app_content %}
<h2 class="fw-bold mb-4">Modelo Predictivo</h2>

<div class="card mb-4">
  <div class="card-body">
    <form id="predictivo-form" class="row g-3" method="post" enctype="multipart/form-data">
      <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
      <div class="col-md-6">
        <label for="file" class="form-label">Archivo de datos</label>
        <input type="file" class="form-control" id="file" name="file" required>
      </div>
      <div class="col-md-4">
        <label for="steps_horizon" class="form-label">Pasos futuros</label>
        <input type="number" class="form-control" id="steps_horizon" name="steps_horizon" value="6" min="1" max="200" required>
      </div>
      <div class="col-md-2 align-self-end">
        <button class="btn btn-primary w-100" type="submit">Ejecutar Pron√≥stico</button>
      </div>
    </form>
  </div>
</div>

{% if metrics %}
<div class="row g-3 mb-4" id="predictivo-metrics">
  {% for key, value in metrics.items() %}
  <div class="col-md-3">
    <div class="p-3 border rounded text-center">{{ key }}: {{ value }}</div>
  </div>
  {% endfor %}
</div>
{% endif %}

{% if table %}
<div class="card mb-4">
  <div class="card-body">
    <div class="table-responsive">
      <table id="predictivo-table" class="table table-sm">
        <thead>
          <tr>
            {% for col in table[0].keys() %}
            <th>{{ col }}</th>
            {% endfor %}
          </tr>
        </thead>
        <tbody>
          {% for row in table %}
          <tr>
            {% for value in row.values() %}
            <td>{{ value }}</td>
            {% endfor %}
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    {% if download_url %}
    <a id="predictivo-download" class="btn btn-secondary mt-3" href="{{ download_url }}">Descargar Resultados</a>
    {% endif %}
  </div>
</div>
{% endif %}

{% endblock %}
