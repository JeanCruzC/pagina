<!-- Información de Progreso en Tiempo Real -->
<div class="alert alert-primary mb-4" id="progress-info">
  <h5>⏱️ Progreso de Optimización</h5>
  <div class="row">
    <div class="col-md-6">
      <strong>🧠 PuLP (Programación Lineal):</strong>
      <div class="progress mt-2 mb-2">
        <div class="progress-bar" id="pulp-progress" role="progressbar" style="width: 0%">0%</div>
      </div>
      <small class="text-muted" id="pulp-time">Iniciando...</small>
    </div>
    <div class="col-md-6">
      <strong>🎯 Greedy (Heurístico):</strong>
      <div class="progress mt-2 mb-2">
        <div class="progress-bar bg-success" id="greedy-progress" role="progressbar" style="width: 0%">0%</div>
      </div>
      <small class="text-muted" id="greedy-time">Iniciando...</small>
    </div>
  </div>
  <div class="mt-3">
    <strong>📊 Tiempos Estimados:</strong>
    <ul class="mb-0">
      <li><strong>Greedy:</strong> 1-2 minutos (más rápido, heurístico)</li>
      <li><strong>PuLP:</strong> 2-4 minutos (más lento, óptimo matemático)</li>
    </ul>
  </div>
</div>

<script>
// Actualizar progreso en tiempo real
function updateProgress() {
  const jobId = window.location.pathname.split('/').pop();
  
  fetch(`/resultados/${jobId}/refresh`)
    .then(response => response.json())
    .then(data => {
      // Actualizar PuLP
      if (data.pulp_progress) {
        const pulpBar = document.getElementById('pulp-progress');
        const pulpTime = document.getElementById('pulp-time');
        if (pulpBar) {
          const progress = parseInt(data.pulp_progress);
          pulpBar.style.width = progress + '%';
          pulpBar.textContent = progress + '%';
          if (progress >= 100) {
            pulpBar.classList.add('bg-success');
          }
        }
        if (pulpTime && data.pulp_time) {
          pulpTime.textContent = data.pulp_time;
        }
      }
      
      // Actualizar Greedy
      if (data.greedy_progress) {
        const greedyBar = document.getElementById('greedy-progress');
        const greedyTime = document.getElementById('greedy-time');
        if (greedyBar) {
          const progress = parseInt(data.greedy_progress);
          greedyBar.style.width = progress + '%';
          greedyBar.textContent = progress + '%';
        }
        if (greedyTime && data.greedy_time) {
          greedyTime.textContent = data.greedy_time;
        }
      }
      
      // Ocultar progreso si ambos están completos
      if (data.has_greedy_results && data.has_pulp_results) {
        const progressInfo = document.getElementById('progress-info');
        if (progressInfo) {
          progressInfo.style.display = 'none';
        }
      }
    })
    .catch(error => console.log('Progress update error:', error));
}

// Actualizar cada 5 segundos
if (window.location.pathname.includes('/resultados/')) {
  setInterval(updateProgress, 5000);
  updateProgress(); // Llamada inicial
}
</script>
